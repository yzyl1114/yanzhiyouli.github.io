<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoalCountdown - è€ƒè¯•å€’è®¡æ—¶</title>
  <link rel="stylesheet" href="css/style.css">

  <!-- æ—¶åŒºåº“ -->
  <script src="js/moment.min.js"></script>
  <script src="js/moment-timezone-with-data-10-year-range.min.js"></script>

  <!-- è°·æ­Œå¹¿å‘Š -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7268374810307592" crossorigin="anonymous"></script>

  <!-- ä»Šå¤©åŒ—äº¬æ—¶é—´ -->
  <script>
    function setTodayBJ(){
      const weekdays = ["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
      const bj = moment.tz("Asia/Shanghai");
      const str = `${bj.year()}å¹´${bj.month()+1}æœˆ${bj.date()}æ—¥ï¼Œæ˜ŸæœŸ${weekdays[bj.day()]}`;
      document.addEventListener('DOMContentLoaded', ()=>{
        document.getElementById('current-date').textContent = str;
      });
    }
    setTodayBJ();
  </script>
</head>

<body>
  <!-- æ ‡é¢˜æ  -->
  <header class="header">
  <div class="logo-container">
    <img src="images/logo.png" alt="GoalCountdown Logo" class="logo">
    <h1>GoalCountdown</h1>
  </div>
  <div class="date-container" style="margin-left: auto; margin-right: 4px;">
    <span id="current-date">2025å¹´01æœˆ01æ—¥ï¼Œæ˜ŸæœŸä¸‰</span>
  </div>
  <!-- ç»Ÿä¸€å¤´åƒå…¥å£ -->
  <div id="user-bar-container"></div>
  </header>

  <!-- Banner -->
  <section class="banner">
    <img src="images/banner.jpg" alt="è€ƒè¯•å€’è®¡æ—¶ç½‘ç«™å®£ä¼ " class="banner-image">
  </section>

  <!-- å€’è®¡æ—¶å…¥å£ -->
  <section class="countdown-entries">
    <div class="entry-grid"></div>
  </section>

  <!-- å¤‡æ¡ˆ -->
  <footer class="footer">
    <div class="beian">
      <a href="https://beian.mps.gov.cn/#/query/webSearch?code=11010502057033" target="_blank" rel="noreferrer">
        <img src="images/beian.png" alt="å…¬å®‰è”ç½‘å¤‡æ¡ˆå›¾æ ‡"> äº¬å…¬ç½‘å®‰å¤‡11010502057033å·
      </a>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="noreferrer">äº¬ICPå¤‡2024094021å·</a>
    </div>
    <div class="contact">
      <span>å•†åŠ¡åˆä½œ goalcountdown@gmail.com</span>
    </div>
  </footer>

  <!-- æ´»åŠ¨å¼¹çª— -->
  <div class="modal activity-modal" id="activity-modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2 class="modal-title">æ–°ç”¨æˆ·ä¸“äº«æ´»åŠ¨</h2>
      <div class="modal-body">
        <p>æ³¨å†Œå³é€3æ¬¡è‡ªå®šä¹‰å€’è®¡æ—¶æœºä¼šï¼</p>
        <button class="btn-primary">ç«‹å³å‚ä¸</button>
      </div>
    </div>
  </div>

  <!-- éšè—æŒ‰é’®ï¼ˆæ”¯ä»˜/æ–°å»º/ç¼–è¾‘ï¼‰ -->
  <button id="btn-open-pay" style="display:none"
    onclick="window.open('member-buy.html','_blank','width=400,height=500,left=200,top=100')"></button>
  <button id="btn-open-new" style="display:none"
    onclick="window.open('custom-goal.html','_blank','width=400,height=420,left=200,top=100')"></button>
  <button id="btn-open-edit" style="display:none"
    onclick="window.open('custom-goal.html?edit='+this.dataset.gid,'_blank','width=400,height=420,left=200,top=100')"></button>

  <!-- ä¸»è„šæœ¬ -->
  <script type="module">
      import { supabase } from './js/supabase.js';
      import { getUser, logout } from './js/auth.js';
      import { getMyCustomGoals, deleteCustomGoal } from './js/custom.js';
      import { exams } from './js/exams.js';

      // ä¿®å¤ï¼šæ­£ç¡®å¤„ç†å¾®ä¿¡ç™»å½•å›è°ƒ
      async function handleAuthCallback() {
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
    
        console.log('URL å‚æ•°:', Object.fromEntries(urlParams));
    
        if (code) {
            console.log('handleAuthCallback: æ£€æµ‹åˆ°codeï¼Œä½†åº”è¯¥å·²è¢«mainå‡½æ•°å¤„ç†');
            return true;
        }
        return false;
      }

      // ç”¨æˆ·å°å¼¹çª—åŠŸèƒ½
      function toggleUserPopup(user) {
          console.log('æ˜¾ç¤ºç”¨æˆ·å¼¹çª—');
          
          // å…ˆç§»é™¤å·²å­˜åœ¨çš„å¼¹çª—
          const existingPopup = document.getElementById('user-popup');
          if (existingPopup) {
              existingPopup.remove();
              return;
          }
          
          const pop = document.createElement('div');
          pop.id = 'user-popup';
          pop.style.cssText = 'position:absolute;right:12px;top:52px;width:220px;background:#fff;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.15);font-size:14px;z-index:999;overflow:hidden';
          pop.innerHTML = `
              <div style="padding:16px;display:flex;align-items:center;border-bottom:1px solid #f0f0f0">
              <img src="${user.avatar_url||'images/default-avatar.png'}" style="width:40px;height:40px;border-radius:50%;margin-right:12px">
              <div style="flex:1">
                  <div style="font-weight:500">${user.username||'ç”¨æˆ·'}</div>
                  <div style="font-size:12px;color:#666">${user.is_member?(user.member_plan==='month'?'åŸºç¡€ç‰ˆ':'å°Šäº«ç‰ˆ')+'ä¼šå‘˜':'æ™®é€šç”¨æˆ·'}</div>
              </div>
              </div>
              <div style="padding:12px 16px;font-size:12px;color:#666;display:flex;justify-content:space-between;align-items:center">
              <span>${user.is_member?'å°†äº '+Math.ceil((new Date(user.member_expires_at)-Date.now())/86400000)+' å¤©ååˆ°æœŸ':'å¼€é€šä¼šå‘˜ç«‹äº«æƒç›Š'}</span>
              ${!user.is_member?'<span id="popup-buy" style="color:#4a6bff;cursor:pointer">å¼€é€š</span>':''}
              </div>
              <div style="border-top:1px solid #f0f0f0;padding:8px;text-align:center">
              <button id="popup-out" style="border:none;background:none;color:#ff4d4f;font-size:13px;cursor:pointer">é€€å‡ºç™»å½•</button>
              </div>`;
          document.body.appendChild(pop);
          
          // ç»‘å®šäº‹ä»¶
          if (!user.is_member) {
              pop.querySelector('#popup-buy').onclick = (e) => {
                  e.stopPropagation();
                  document.getElementById('btn-open-pay').click();
                  pop.remove();
              };
          }
          
          pop.querySelector('#popup-out').onclick = async (e) => {
              e.stopPropagation();
              await logout(); 
              location.reload();
          };
          
          // ç‚¹å‡»å¤–éƒ¨å…³é—­å¼¹çª—
          const closePopup = (e) => {
              if (!e.target.closest('#user-popup') && !e.target.closest('.user-bar')) {
                  pop.remove();
                  document.removeEventListener('click', closePopup);
              }
          };
          setTimeout(() => document.addEventListener('click', closePopup), 0);
      }

      // æ¸²æŸ“ç”¨æˆ·æ å‡½æ•°
      function renderUserBar(user) {
          const container = document.getElementById('user-bar-container');
          if (!container) {
              console.error('ç”¨æˆ·æ å®¹å™¨ä¸å­˜åœ¨');
              return;
          }

          console.log('æ¸²æŸ“ç”¨æˆ·æ ï¼Œç”¨æˆ·çŠ¶æ€:', user);
          
          // æ¸…ç©ºå®¹å™¨
          container.innerHTML = '';

          const wrap = document.createElement('div');
          wrap.className = 'user-bar';
          wrap.style.cssText = `
              margin-left: auto;
              margin-right: 20px;
              cursor: pointer;
              display: flex;
              align-items: center;
              gap: 10px;
          `;

          if (user) {
              // å·²ç™»å½•ç”¨æˆ·
              let userStatus = 'æ™®é€šç”¨æˆ·';
              let statusStyle = 'color: #666; font-size: 12px;';
              
              if (user.is_member) {
                  userStatus = user.member_plan === 'month' ? 'åŸºç¡€ç‰ˆä¼šå‘˜' : 'å°Šäº«ç‰ˆä¼šå‘˜';
                  statusStyle = 'color: #4a6bff; font-size: 12px;';
              }
              
              wrap.innerHTML = `
                  <img src="${user.avatar_url || 'images/default-avatar.png'}" 
                      style="width:40px;height:40px;border-radius:50%;border: 2px solid ${user.is_member ? '#4a6bff' : '#ddd'};">
              `;
                // ç‚¹å‡»å¤´åƒæ˜¾ç¤ºç”¨æˆ·å¼¹çª—
              wrap.onclick = (e) => {
                  e.stopPropagation();
                  console.log('ç‚¹å‡»ç”¨æˆ·å¤´åƒ');
                  toggleUserPopup(user);
              };

              console.log('âœ… å·²ç™»å½•ç”¨æˆ·æ æ¸²æŸ“å®Œæˆ');
          } else {
              // æœªç™»å½•ç”¨æˆ·
              wrap.innerHTML = `
                  <img src="images/default-avatar.png" 
                      style="width:40px;height:40px;border-radius:50%;border: 2px solid #ddd;">
              `;
              // ç‚¹å‡»äº‹ä»¶ - å¾®ä¿¡ç™»å½•
              wrap.onclick = (e) => {
                  e.stopPropagation();
                  console.log('ç‚¹å‡»ç™»å½•æŒ‰é’®');
                  // å¾®ä¿¡æ‰«ç ç™»å½•
                  window.location.href='https://open.weixin.qq.com/connect/qrconnect?appid=wxd4e5f7a42fa74524&redirect_uri=' + encodeURIComponent('https://goalcountdown.com/api/wechat-login') + '&response_type=code&scope=snsapi_login&state=123#wechat_redirect';
              };
              console.log('âœ… æœªç™»å½•ç”¨æˆ·æ æ¸²æŸ“å®Œæˆ');
          }
          
          container.appendChild(wrap);
          console.log('ç”¨æˆ·æ å·²æ·»åŠ åˆ°å®¹å™¨');
      }

      // ä¸»æ‰§è¡Œæµç¨‹
      async function main() {
          console.log('å¼€å§‹ä¸»æµç¨‹...');
          // å…ˆå¤„ç†æ”¯ä»˜æˆåŠŸ
          handlePaymentSuccess();
          
          // ğŸ”¥ å…³é”®ä¿®å¤ï¼šæ£€æŸ¥ç™»å½•é‡å®šå‘å‚æ•°
          const urlParams = new URLSearchParams(window.location.search);
          const loginSuccess = urlParams.get('login_success');
          const userData = urlParams.get('user_data');
          const loginError = urlParams.get('login_error');
          const code = urlParams.get('code');
        
          console.log('URLå‚æ•°:', { loginSuccess, userData: userData ? 'æœ‰æ•°æ®' : 'æ— ', loginError, code });
        
          // æƒ…å†µ1ï¼šå¤„ç†ç™»å½•æˆåŠŸé‡å®šå‘
          if (loginSuccess === 'true' && userData) {
              console.log('ğŸ”¥ æ£€æµ‹åˆ°ç™»å½•æˆåŠŸé‡å®šå‘');
              try {
                  const userInfo = JSON.parse(decodeURIComponent(userData));
                  console.log('ç™»å½•æˆåŠŸï¼Œç”¨æˆ·ä¿¡æ¯:', userInfo);
                
                  // ä¿å­˜ç”¨æˆ·ä¿¡æ¯
                  localStorage.setItem('user_info', JSON.stringify(userInfo));
                
                  // æ¸…é™¤URLå‚æ•°
                  const cleanUrl = window.location.origin + window.location.pathname;
                  window.history.replaceState({}, document.title, cleanUrl);
                
                  console.log('âœ… ç”¨æˆ·ä¿¡æ¯å·²ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢');
                  location.reload();
                  return;
              } catch (error) {
                  console.error('è§£æç”¨æˆ·æ•°æ®å¤±è´¥:', error);
              }
          }
        
          // æƒ…å†µ2ï¼šå¤„ç†ç™»å½•é”™è¯¯
          if (loginError) {
              const errorMsg = decodeURIComponent(loginError);
              console.error('ç™»å½•å¤±è´¥:', errorMsg);
              alert('ç™»å½•å¤±è´¥: ' + errorMsg);
            
              // æ¸…é™¤é”™è¯¯å‚æ•°
              const cleanUrl = window.location.origin + window.location.pathname;
              window.history.replaceState({}, document.title, cleanUrl);
          }
        
          // æƒ…å†µ3ï¼šå¦‚æœè¿˜æœ‰codeå‚æ•°ï¼Œè¯´æ˜åç«¯æ²¡æœ‰æ­£ç¡®é‡å®šå‘
          if (code) {
              console.log('âš ï¸ æ£€æµ‹åˆ°codeå‚æ•°ï¼Œä½†åç«¯åº”è¯¥å·²é‡å®šå‘ã€‚æ¸…é™¤å‚æ•°ç»§ç»­...');
              const cleanUrl = window.location.origin + window.location.pathname;
              window.history.replaceState({}, document.title, cleanUrl);
          }      
          
          // å¤„ç†è®¤è¯å›è°ƒ
          const isHandlingCallback = await handleAuthCallback();
          if (isHandlingCallback) {
              return;
          }
          
          // è·å–ç”¨æˆ·ä¿¡æ¯
          const user = await getUser();
          console.log('ç”¨æˆ·ä¿¡æ¯:', user);
          
          // å…³é”®ä¿®å¤ï¼šåˆå¹¶æœ¬åœ°ä¼šå‘˜çŠ¶æ€åˆ°ç”¨æˆ·ä¿¡æ¯
          const userWithMembership = await mergeLocalMembership(user);
          console.log('åˆå¹¶åçš„ç”¨æˆ·ä¿¡æ¯:', userWithMembership);
            
          // æ¸²æŸ“ç”¨æˆ·æ  - ä½¿ç”¨åˆå¹¶åçš„ç”¨æˆ·ä¿¡æ¯
          renderUserBar(userWithMembership);
          
          /* ---- æ¸²æŸ“å¡ç‰‡ ---- */
          const grid = document.querySelector('.entry-grid');
          if (!grid) {
              console.error('æ‰¾ä¸åˆ° .entry-grid å…ƒç´ ');
              return;
          }

          // 1. ç³»ç»Ÿè€ƒè¯•ï¼ˆå¿…ç°ï¼‰
          function renderCountdownEntries(){
              const now = moment.tz('Asia/Shanghai');
              const sorted = [...exams].sort((a,b)=> moment(a.date).diff(now) - moment(b.date).diff(now));
              sorted.forEach(exam=>{
                  const diff = moment(exam.date).diff(now);
                  const div = document.createElement('div');
                  div.className='entry-item' + (diff<=0 ? ' entry-ended' : '');
                  div.innerHTML=`
                      ${diff<=0?'<div class="overlay"></div><div class="ended-badge">å·²ç»“æŸ</div>':''}
                      <img src="${exam.image}" class="entry-image">
                      <h3 class="entry-title">${exam.name}</h3>`;
                  div.onclick=()=> location.href=`countdown.html?id=${exam.id}`;
                  grid.appendChild(div);
              });
          }
          renderCountdownEntries();

          // 2. å·²åˆ›å»ºçš„è‡ªå®šä¹‰ç›®æ ‡
          if (user) {
              try {
                  const list = await getMyCustomGoals();
                  list.forEach(g => renderCustomGoalCard(g));
              } catch (error) {
                  console.error('è·å–è‡ªå®šä¹‰ç›®æ ‡å¤±è´¥:', error);
              }
          }

          // 3. ã€Œ+ã€å¡ç‰‡ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰
          const plus = document.createElement('div');
          plus.className='entry-item custom-plus';
          plus.innerHTML=`<img src="images/plus.svg" class="entry-image"><h3 class="entry-title">è‡ªå®šä¹‰ç›®æ ‡</h3>`;
          plus.onclick=async (e)=>{
              e.stopPropagation();
              console.log('ç‚¹å‡»è‡ªå®šä¹‰ç›®æ ‡ï¼Œç”¨æˆ·çŠ¶æ€:', userWithMembership);
              if(!userWithMembership){ 
                  // è§¦å‘ç™»å½•
                  const userBar = document.querySelector('.user-bar');
                  if (userBar) userBar.click(); 
                  return; 
              }

              // ğŸ”¥ å…³é”®ä¿®å¤ï¼šæ£€æŸ¥ä¼šå‘˜çŠ¶æ€ï¼ˆåŒ…æ‹¬æœ¬åœ°ä¼šå‘˜ï¼‰
              const isMember = userWithMembership.is_member || 
                              (userWithMembership.local_membership && userWithMembership.member_plan);

              if(!isMember){ 
                  console.log('éä¼šå‘˜ï¼Œæ‰“å¼€ä¼šå‘˜è´­ä¹°é¡µ');
                  document.getElementById('btn-open-pay').click(); 
                  return; 
              }
              
              // æ£€æŸ¥ç›®æ ‡æ•°é‡é™åˆ¶
              const currentGoals = await getMyCustomGoals();
              const memberPlan = userWithMembership.member_plan || 'month';
              const maxGoals = memberPlan === 'month' ? 3 : 5;  // âœ… æ­£ç¡®ï¼šä½¿ç”¨ memberPlan
                    
              console.log(`å½“å‰ç›®æ ‡æ•°: ${currentGoals.length}, æœ€å¤§é™åˆ¶: ${maxGoals}, ä¼šå‘˜ç±»å‹: ${memberPlan}`);              
              
              if (currentGoals.length >= maxGoals) {
                  if (user.member_plan === 'month') {
                      alert('å‡çº§å°Šäº«ç‰ˆä¼šå‘˜ï¼Œåˆ›å»ºæ›´å¤šç›®æ ‡');
                      document.getElementById('btn-open-pay').click();
                  } else {
                      alert('è‡ªå®šä¹‰ç›®æ ‡å·²è¾¾æœ€å¤šé™åˆ¶ï¼Œå¯åˆ é™¤æ—§ç›®æ ‡åæ–°å»º');
                  }
                  return;
              }
              
              console.log('ä¼šå‘˜ï¼Œæ‰“å¼€æ–°å»ºç›®æ ‡');
              document.getElementById('btn-open-new').click();
          };
          grid.appendChild(plus);

          console.log('ä¸»æµç¨‹å®Œæˆ');
      }

        // æ–°å¢ï¼šåˆå¹¶æœ¬åœ°ä¼šå‘˜çŠ¶æ€å‡½æ•°
      async function mergeLocalMembership(user) {
          if (!user) return user;
            
          try {
              const localMembership = localStorage.getItem('user_membership');
              if (localMembership) {
                  const membership = JSON.parse(localMembership);
                  console.log('å‘ç°æœ¬åœ°ä¼šå‘˜çŠ¶æ€:', membership);
                    
                  if (membership.isMember && new Date(membership.expires) > new Date()) {
                        // æœ¬åœ°ä¼šå‘˜çŠ¶æ€æœ‰æ•ˆ
                      return {
                          ...user,
                          is_member: true,
                          member_plan: membership.plan,
                          member_expires_at: membership.expires,
                          local_membership: true // æ ‡è®°ä¸ºæœ¬åœ°ä¼šå‘˜
                      };
                  } else {
                        // æœ¬åœ°ä¼šå‘˜å·²è¿‡æœŸï¼Œæ¸…ç†
                      localStorage.removeItem('user_membership');
                      console.log('æ¸…ç†è¿‡æœŸçš„æœ¬åœ°ä¼šå‘˜çŠ¶æ€');
                  }
              }
          } catch (error) {
              console.error('åˆå¹¶æœ¬åœ°ä¼šå‘˜çŠ¶æ€å¤±è´¥:', error);
          }
            
          return user;
      }

      // è¾…åŠ©å‡½æ•° - æ¸²æŸ“è‡ªå®šä¹‰ç›®æ ‡å¡ç‰‡
      function renderCustomGoalCard(g){
          const grid = document.querySelector('.entry-grid');
          if (!grid) return;
          
          const item=document.createElement('div');
          item.className='entry-item custom-goal';
          item.style.position='relative';
          
          // æ ¹æ®åˆ†ç±»é€‰æ‹©å›¾ç‰‡
          let imageSrc = 'images/custom-plus.jpg'; // é»˜è®¤å›¾ç‰‡
          switch(g.category) {
              case 'work':
                  imageSrc = 'images/work.png';
                  break;
              case 'life':
                  imageSrc = 'images/life.png';
                  break;
              case 'other':
                  imageSrc = 'images/others.png';
                  break;
              case 'exam':
              default:
                  imageSrc = 'images/custom-plus.jpg';
          }
          
          item.innerHTML=`
              <img src="${imageSrc}" class="entry-image" onerror="this.src='images/custom-plus.jpg'">
              <h3 class="entry-title">${g.name}</h3>
              <div class="custom-goal-actions" style="display:none;position:absolute;top:6px;right:6px;display:flex;gap:4px;">
                  <i class="edit-icon" style="background:rgba(0,0,0,.5);color:#fff;border-radius:3px;padding:2px 4px;font-size:12px;cursor:pointer">âœï¸</i>
                  <i class="del-icon" style="background:rgba(0,0,0,.5);color:#fff;border-radius:3px;padding:2px 4px;font-size:12px;cursor:pointer">ğŸ—‘ï¸</i>
              </div>`;
          item.onclick=()=> location.href=`countdown.html?custom=${g.id}`;
          item.onmouseenter=()=> item.querySelector('.custom-goal-actions').style.display='flex';
          item.onmouseleave=()=> item.querySelector('.custom-goal-actions').style.display='none';
          item.querySelector('.edit-icon').onclick=e=>{
              e.stopPropagation();
              const btn=document.getElementById('btn-open-edit');
              btn.dataset.gid=g.id;
              btn.click();
          };
          item.querySelector('.del-icon').onclick=async e=>{
              e.stopPropagation();
              if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ')) return;
              try {
                  await deleteCustomGoal(g.id);
                  alert('å·²åˆ é™¤');
                  location.reload();
              } catch (error) {
                  alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
              }
          };
          grid.appendChild(item);
      }
      // æ·»åŠ æ”¯ä»˜æˆåŠŸå¤„ç†
      function handlePaymentSuccess() {
          const urlParams = new URLSearchParams(window.location.search);
          const paymentSuccess = urlParams.get('payment') === 'success' || 
                          localStorage.getItem('payment_success') === 'true';
        
          if (paymentSuccess) {
              console.log('æ£€æµ‹åˆ°æ”¯ä»˜æˆåŠŸï¼Œåˆ·æ–°ç”¨æˆ·çŠ¶æ€');
            
              // æ¸…ç†æ”¯ä»˜æˆåŠŸæ ‡è®°
              localStorage.removeItem('payment_success');
              localStorage.removeItem('payment_plan');
              localStorage.removeItem('payment_timestamp');
            
              // æ¸…é™¤URLå‚æ•°ï¼Œé¿å…é‡å¤è§¦å‘
              if (urlParams.get('payment') === 'success') {
                  const cleanUrl = window.location.origin + window.location.pathname;
                  window.history.replaceState({}, document.title, cleanUrl);
              }
            
              // æ˜¾ç¤ºæˆåŠŸæç¤ºå¹¶å¼ºåˆ¶åˆ·æ–°é¡µé¢åº”ç”¨ä¼šå‘˜æƒé™
              setTimeout(() => {
                  alert('ä¼šå‘˜å¼€é€šæˆåŠŸï¼æ¬¢è¿ä½¿ç”¨ä¼šå‘˜åŠŸèƒ½ã€‚');
                  // å¼ºåˆ¶åˆ·æ–°ä»¥ç¡®ä¿ä¼šå‘˜æƒé™ç”Ÿæ•ˆ
                  location.reload();
              }, 500);
          }
      }
      // å¯åŠ¨ä¸»æµç¨‹
      main().catch(console.error);
  </script>